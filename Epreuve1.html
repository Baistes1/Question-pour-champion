<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Questions pour un Champion</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      background-color: #000;
      color: #fff;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }

    /* Étoiles */
    .stars {
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
    }

    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 3s infinite;
    }

    .star.small { width: 1px; height: 1px; }
    .star.medium { width: 2px; height: 2px; }
    .star.large { width: 3px; height: 3px; }

    @keyframes twinkle {
      0%, 100% { opacity: 0.25; }
      50% { opacity: 1; }
    }

    /* Layout global : top + separator + bottom = 100vh */
    .game {
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .top-section {
      flex: 0 0 62%;
      background: linear-gradient(to bottom, #012A6D, #005BBB);
      display: flex;
      padding: 20px;
      gap: 20px;
      position: relative;
      min-height: 0;
    }

    .separator {
      flex: 0 0 3px;
      height: 3px;
      background: linear-gradient(to right, transparent, #F8D54B, transparent);
      box-shadow: 0 0 10px #F2A900;
    }

    .bottom-section {
      flex: 1;
      background-color: #001A4D;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      padding: 20px;
      min-height: 0;
    }

    /* Colonnes avatars */
    .avatar-column {
      width: 15%;
      min-width: 160px;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      align-items: center;
      gap: 20px;
    }

    .player {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }

    .avatar {
      width: 10vmin;
      height: 10vmin;
      min-width: 100px;
      min-height: 100px;
      border-radius: 50%;
      background: linear-gradient(135deg, #012A6D, #005BBB);
      position: relative;
      overflow: hidden;

      border: 3px solid rgba(255, 255, 255, 0.3);
      box-shadow:
        0 0 0 4px #F2A900,
        0 0 20px #F8D54B,
        0 0 15px rgba(0, 0, 0, 0.5);
      border-color: #F8D54B;
    }

    .avatar.active {
      box-shadow:
        0 0 0 5px #ffffff,
        0 0 0 10px #F2A900,
        0 0 30px rgba(248, 213, 75, 0.9);
      transform: scale(1.02);
      transition: transform 0.2s ease;
    }

    .avatar-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* Placeholder : par défaut caché, affiché si image KO */
    .avatar-placeholder {
      position: absolute;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 3vmin;
      font-weight: bold;
    }

    .points {
      margin-top: 10px;
      background-color: #F2A900;
      color: #012A6D;
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: 700;
      font-size: 2vmin;
      text-align: center;
      min-width: 90px;
    }

    /* Zone question */
    .question-area {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0 20px;
      min-width: 0;
    }

    .question-box {
      background-color: rgba(32, 69, 213, 0.12);
      border: 2px solid rgba(255, 225, 0, 0.75);
      border-radius: 15px;
      padding: 28px;
      width: 100%;
      max-width: 900px;
      text-align: center;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    }

    .question-text {
      font-size: clamp(18px, 4vmin, 44px);
      line-height: 1.35;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      word-wrap: break-word;
    }

    /* Buzzer / Timer */
    .buzzer-area {
      position: absolute;
      top: -68px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }

    .timer {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #ff6b6b, #cc0000);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 36px;
      font-weight: 800;
      color: white;
      cursor: pointer;
      border: 8px solid #c11d1d;
      position: relative;

      box-shadow:
        0 0 40px rgba(255, 71, 87, 0.8),
        0 0 80px rgba(0, 0, 0, 0.4),
        inset 0 -8px 20px rgba(0, 0, 0, 0.3),
        inset 0 8px 20px rgba(255, 255, 255, 0.2);
    }

    .timer::before {
      content: "";
      position: absolute;
      width: 140px;
      height: 140px;
      border-radius: 50%;
      border: 4px dashed rgba(155, 41, 41, 0.6);
      animation: rotate 4s linear infinite;
    }

    .timer::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.28), transparent);
    }

    .timer.pulsing {
      animation: buzzerPulse 1s infinite;
    }

    .timer:active {
      transform: scale(0.96);
    }

    .timer.buzzed {
      background: radial-gradient(circle at 30% 30%, #66bb6a, #2e7d32);
      border-color: #1b5e20;
      box-shadow:
        0 0 40px rgba(102,187,106,0.8),
        0 0 80px rgba(102,187,106,0.4),
        inset 0 -8px 20px rgba(0,0,0,0.3),
        inset 0 8px 20px rgba(255,255,255,0.2);
      animation: none;
    }

    .timer.buzzed::before {
      border-color: rgba(102,187,106,0.6);
      animation: none;
    }

    @keyframes buzzerPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Réponses */
    .answers-container {
      width: min(1100px, 92vw);
      height: min(320px, 70%);
      display: flex;
      gap: 18px;
      padding: 18px;

      background-color: #012A6D;
      border: 3px solid #F8D54B;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .answer-column {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 18px;
    }

    .answer-box {
      flex: 1;
      background-color: #F8D54B;
      color: #012A6D;
      padding: 18px;
      border-radius: 10px;
      font-size: clamp(16px, 2.4vmin, 28px);
      font-weight: 800;
      text-align: center;

      display: flex;
      align-items: center;
      justify-content: center;

      border: 2px solid #F2A900;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.15s ease, background-color 0.15s ease;
      user-select: none;
    }

    .answer-box:hover {
      background-color: #F2A900;
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      border-color: #012A6D;
    }

    .answer-box.correct {
      background-color: #33cc33;
      color: #fff;
      border-color: #229922;
    }

    .answer-box.wrong {
      background-color: #cc0000;
      color: #fff;
      border-color: #990000;
    }

    /* Responsive : si écran étroit, colonnes avatars plus petites */
    @media (max-width: 900px) {
      .avatar-column { min-width: 130px; }
      .top-section { padding: 14px; gap: 12px; }
      .question-box { padding: 18px; }
      .buzzer-area { top: -62px; }
      .timer { width: 110px; height: 110px; font-size: 34px; }
      .timer::before { width: 130px; height: 130px; }
    }
  </style>
</head>

<body>
  <div class="stars" id="stars"></div>

  <div class="game">
    <!-- Partie supérieure -->
    <div class="top-section">
      <!-- Colonne avatars gauche -->
      <div class="avatar-column left">
        <div class="player" data-player="1">
          <div class="avatar active">
            <img src="" alt="Joueur 1" class="avatar-img" />
            <div class="avatar-placeholder">1</div>
          </div>
          <div class="points">450 pts</div>
        </div>

        <div class="player" data-player="2">
          <div class="avatar">
            <img src="" alt="Joueur 2" class="avatar-img" />
            <div class="avatar-placeholder">2</div>
          </div>
          <div class="points">380 pts</div>
        </div>
      </div>

      <!-- Zone question -->
      <div class="question-area">
        <div class="question-box">
          <div class="question-text">
            Quelle est la capitale de la Norvège, pays scandinave connu pour ses fjords et ses aurores boréales ?
          </div>
        </div>
      </div>

      <!-- Colonne avatars droite -->
      <div class="avatar-column right">
        <div class="player" data-player="3">
          <div class="avatar">
            <img src="" alt="Joueur 3" class="avatar-img" />
            <div class="avatar-placeholder">3</div>
          </div>
          <div class="points">520 pts</div>
        </div>

        <div class="player" data-player="4">
          <div class="avatar">
            <img src="" alt="Joueur 4" class="avatar-img" />
            <div class="avatar-placeholder">4</div>
          </div>
          <div class="points">290 pts</div>
        </div>
      </div>
    </div>

    <!-- Séparateur -->
    <div class="separator"></div>

    <!-- Partie inférieure -->
    <div class="bottom-section">
      <!-- Timer -->
      <div class="buzzer-area">
        <div class="timer pulsing" id="timer">12s</div>
      </div>

      <!-- Réponses -->
      <div class="answers-container" id="answers">
        <div class="answer-column left">
          <div class="answer-box" data-answer="a">Stockholm</div>
          <div class="answer-box" data-answer="b">Helsinki</div>
        </div>
        <div class="answer-column right">
          <div class="answer-box" data-answer="c">Oslo</div>
          <div class="answer-box" data-answer="d">Copenhague</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ========= ÉTOILES ========= */
    const starsContainer = document.getElementById("stars");
    const numberOfStars = 150;

    for (let i = 0; i < numberOfStars; i++) {
      const star = document.createElement("div");
      star.className = "star";

      const size = Math.random();
      if (size < 0.3) star.classList.add("small");
      else if (size < 0.7) star.classList.add("medium");
      else star.classList.add("large");

      star.style.left = Math.random() * 100 + "%";
      star.style.top = Math.random() * 100 + "%";
      star.style.animationDelay = Math.random() * 5 + "s";
      star.style.animationDuration = 2 + Math.random() * 4 + "s";
      star.style.opacity = 0.2 + Math.random() * 0.8;

      if (Math.random() > 0.85) {
        const colors = ["#FFD700", "#87CEEB", "#FF6B6B", "#98FB98"];
        const color = colors[Math.floor(Math.random() * colors.length)];
        star.style.backgroundColor = color;
        star.style.boxShadow = `0 0 ${2 + Math.random() * 4}px ${color}`;
      }

      starsContainer.appendChild(star);
    }

    /* ========= AVATARS ========= */
    const AVATAR_PATH = "assets/avatars/"; // <-- change si besoin

    const avatarsConfig = {
      bleu: { name: "Le Calme", color: "BLEU", filename: "bleu.png" },
      gris: { name: "Le Sage", color: "GRIS", filename: "gris.png" },
      jaune: { name: "L'Optimiste", color: "JAUNE", filename: "jaune.png" },
      orange: { name: "L'Énergique", color: "ORANGE", filename: "orange.png" },
      rose: { name: "Le Romantique", color: "ROSE", filename: "rose.png" },
      rouge: { name: "Le Passionné", color: "ROUGE", filename: "rouge.png" },
      turquoise: { name: "Le Créatif", color: "TURQUOISE", filename: "turquoi.png" },
      vert: { name: "L'Écologique", color: "VERT", filename: "vert.png" },
      violet: { name: "Le Mystique", color: "VIOLET", filename: "violet.png" }
    };

    const playersAvatars = {
      "1": "rose",
      "2": "turquoise",
      "3": "jaune",
      "4": "orange"
    };

    function getColorForAvatar(avatarType) {
      const colorMap = {
        bleu: "#3b82f6",
        gris: "#6b7280",
        jaune: "#f59e0b",
        orange: "#f97316",
        rose: "#ec4899",
        rouge: "#ef4444",
        turquoise: "#06b6d4",
        vert: "#10b981",
        violet: "#8b5cf6"
      };
      return colorMap[avatarType] || "#475569";
    }

    function loadPlayerAvatars() {
      const players = document.querySelectorAll(".player");

      players.forEach((player) => {
        const playerNum = player.dataset.player;
        const avatarType = playersAvatars[playerNum];

        const avatarImg = player.querySelector(".avatar-img");
        const placeholder = player.querySelector(".avatar-placeholder");

        placeholder.style.display = "none";
        avatarImg.style.display = "block";

        if (!avatarType || !avatarsConfig[avatarType]) return;

        const cfg = avatarsConfig[avatarType];
        avatarImg.src = AVATAR_PATH + cfg.filename;
        avatarImg.alt = `Joueur ${playerNum} - ${cfg.name}`;

        avatarImg.onerror = function () {
          this.style.display = "none";
          placeholder.style.display = "flex";
          placeholder.textContent = playerNum;
          placeholder.style.backgroundColor = getColorForAvatar(avatarType);
        };

        avatarImg.onload = function () {
          placeholder.style.display = "none";
          this.style.display = "block";
        };
      });
    }

    /* ========= TIMER / BUZZER ========= */
    const timerElement = document.getElementById("timer");
    const answerBoxes = document.querySelectorAll(".answer-box");

    let timeLeft = 12;
    let timerInterval = null;
    let answerSelected = false;

    const correctAnswer = "c"; // Oslo

    function setAnswersEnabled(enabled) {
      answerBoxes.forEach((box) => {
        box.style.pointerEvents = enabled ? "auto" : "none";
        box.style.opacity = enabled ? "1" : "0.6";
      });
    }

    function startTimer() {
      clearInterval(timerInterval);
      timeLeft = 12;
      answerSelected = false;

      timerElement.classList.add("pulsing");
      timerElement.classList.remove("buzzed");
      timerElement.textContent = timeLeft + "s";

      setAnswersEnabled(true);
      answerBoxes.forEach((b) => b.classList.remove("correct", "wrong"));

      timerInterval = setInterval(updateTimer, 1000);
    }

    function updateTimer() {
      timeLeft--;
      timerElement.textContent = timeLeft + "s";

      const percent = timeLeft / 12;
      const redValue = Math.floor(255 * (1 - percent * 0.5));
      const inner = `rgb(${redValue}, 50, 50)`;
      const outer = `rgb(${Math.max(redValue - 60, 0)}, 0, 0)`;
      timerElement.style.background = `radial-gradient(circle at 30% 30%, ${inner}, ${outer})`;

      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        timerElement.classList.remove("pulsing");
        timerElement.style.background = "radial-gradient(circle at 30% 30%, #666, #333)";
        timerElement.textContent = "0s";
        setAnswersEnabled(false);
      }
    }

    timerElement.addEventListener("click", function () {
      if (timeLeft <= 0 || answerSelected) return;

      // Buzz
      clearInterval(timerInterval);
      timerElement.classList.remove("pulsing");
      timerElement.classList.add("buzzed");

      activatePlayer(1);
    });

    /* ========= RÉPONSES ========= */
    answerBoxes.forEach((box) => {
      box.addEventListener("click", function () {
        if (answerSelected || timeLeft <= 0) return;

        answerSelected = true;
        clearInterval(timerInterval);
        timerElement.classList.remove("pulsing");

        const userAnswer = this.dataset.answer;

        answerBoxes.forEach((b) => {
          b.style.pointerEvents = "none";
          if (b === this) {
            b.classList.add(userAnswer === correctAnswer ? "correct" : "wrong");
            b.style.transform = "scale(1.03)";
          } else {
            b.style.opacity = "0.6";
            b.style.transform = "scale(1)";
            if (b.dataset.answer === correctAnswer) {
              b.classList.add("correct");
              b.style.opacity = "1";
            }
          }
        });

        if (userAnswer === correctAnswer) updatePlayerScore(50);
      });
    });

    /* ========= JOUEURS ========= */
    function activatePlayer(playerNum) {
      document.querySelectorAll(".avatar").forEach((avatar) => {
        avatar.classList.remove("active");
      });

      const playerAvatar = document.querySelector(`[data-player="${playerNum}"] .avatar`);
      if (playerAvatar) playerAvatar.classList.add("active");
    }

    function updatePlayerScore(points) {
      const activeAvatar = document.querySelector(".avatar.active");
      if (!activeAvatar) return;

      const activePlayer = activeAvatar.closest(".player");
      const pointsElement = activePlayer.querySelector(".points");
      const currentPoints = parseInt(pointsElement.textContent.replace(" pts", ""), 10) || 0;
      pointsElement.textContent = (currentPoints + points) + " pts";
    }

    /* ========= INIT ========= */
    document.addEventListener("DOMContentLoaded", () => {
      // localStorage : avatar du joueur 1 si présent
      const savedAvatar = localStorage.getItem("playerAvatar");
      if (savedAvatar) {
        try {
          const avatar = JSON.parse(savedAvatar);
          const foundKey =
            Object.keys(avatarsConfig).find(
              (key) =>
                avatarsConfig[key].name === avatar.name &&
                avatarsConfig[key].color === avatar.color
            ) || "bleu";
          playersAvatars["1"] = foundKey;
        } catch (_) {}
      }

      loadPlayerAvatars();
      startTimer();
    });
  </script>
</body>
</html>
